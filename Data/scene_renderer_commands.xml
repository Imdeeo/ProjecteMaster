<?xml version="1.0" encoding="ISO-8859-1"?>
<scene_renderer_commands>
	<set_depth_stencil_state enable_z_test="true" write_z_buffer="true"/>
	<set_light_constants/>
	<set_matrices/>
	
<<<<<<< HEAD
	<!--FORWARD<clear render_target="true" depth_stencil="true"/>
	<set_pool_renderable_objects_technique pool="forward_shading"/>
	<render_layer layer="solid" active="true"/>-->
=======
	<set_pool_renderable_objects_technique pool="generate_shadow_map"/>
	<generate_shadow_maps/>
>>>>>>> shadowmap
	
	<set_render_target name="deferred_multiple_render_target">
		<dynamic_texture name="DiffuseMapTexture" texture_width_as_frame_buffer="true" create_depth_stencil_buffer="false"/>
		<dynamic_texture name="LightMapTexture" texture_width_as_frame_buffer="true"/>
		<dynamic_texture name="NormalMapTexture" texture_width_as_frame_buffer="true"/>
		<dynamic_texture name="DepthMapTexture" texture_width_as_frame_buffer="true"/>
	</set_render_target>
	
	<clear render_target="true" depth_stencil="true"/>
	<set_pool_renderable_objects_technique pool="gBuffer"/>
	<render_layer layer="solid" active="true"/>
	
	<unset_render_target/>
	
	<clear render_target="true" depth_stencil="true"/>
	<set_depth_stencil_state enable_z_test="false" write_z_buffer="false"/>
	<render_draw_quad active="true">
		<texture stage_id="0" file="LightMapTexture" load_file="false"/>
	</render_draw_quad>

	<set_pool_renderable_objects_technique pool="deferred_shading_lighting"/>
	<render_deferred_shading>
		<texture stage_id="0" file="DiffuseMapTexture" load_file="false"/>
		<texture stage_id="1" file="LightMapTexture" load_file="false"/>
		<texture stage_id="2" file="NormalMapTexture" load_file="false"/>
		<texture stage_id="3" file="DepthMapTexture" load_file="false"/>
	</render_deferred_shading>
	
	<render_debug_grid/>
	<render_debug_lights/>
	
	<!--<capture_frame_buffer>
		<capture_texture name="CaptureFog" texture_width_as_frame_buffer="true"/>
	</capture_frame_buffer>
	
	<set_pool_renderable_objects_technique pool="deferred_shading_lighting"/>
	<render_draw_quad active="true" material="FogMaterial">
		<texture stage_id="0" file="CaptureFog" load_file="false"/>
		<texture stage_id="1" file="DepthMapTexture" load_file="false"/>
	</render_draw_quad>-->
	
	<capture_frame_buffer>
		<capture_texture name="CapturedZBlurTexture" texture_width_as_frame_buffer="true"/>
	</capture_frame_buffer>
	
	<set_pool_renderable_objects_technique pool="bloom_pool"/>
	<apply_filters>
		<texture stage_id="0" file="CapturedZBlurTexture"/>
		<dynamic_texture name="Bloom" texture_width_as_frame_buffer="true" material="BloomMaterial"/>
		<dynamic_texture name="BloomBlur" texture_width_as_frame_buffer="true" material="BloomBlurMaterial"/>
		<dynamic_texture name="BloomCombine" texture_width_as_frame_buffer="true" material="BloomCombineMaterial"/>
	</apply_filters>
	
	<unset_render_target/>
	
	<set_pool_renderable_objects_technique pool="forward_shading"/>	
	<render_draw_quad active="true">
		<texture stage_id="0" file="BloomCombine" load_file="false"/>
	</render_draw_quad>

	<!--<render_draw_quad material="ZBlurMaterial" active="true">
		<texture stage_id="0" file="CapturedZBlurTexture" load_file="false"/>
	</render_draw_quad>-->
	
	<!--<set_pool_renderable_objects_technique pool="blur_pool"/>
	<apply_filters>
		<texture stage_id="0" file="CapturedZBlurTexture"/>
		<dynamic_texture name="StartZBlur" width="512" height="512" material="GUIMaterial"/>
		<dynamic_texture name="ZBlur3" width="512" height="512" material="BlurMaterial"/>
		<dynamic_texture name="ZBlur2" width="512" height="512" material="BlurMaterial"/>
		<dynamic_texture name="ZBlur1" width="512" height="512" material="BlurMaterial"/>
		<dynamic_texture name="ZBlur" width="512" height="512" material="BlurMaterial"/>
	</apply_filters>
	
	<unset_render_target/>
	
	<set_pool_renderable_objects_technique pool="forward_shading"/>	
	<render_draw_quad active="true">
		<texture stage_id="0" file="StartZBlur" load_file="false"/>
	</render_draw_quad>-->
	
	<!--<render_draw_quad material="NoiseAndVignettingMaterial" active="true">
		<texture stage_id="0" file="Data/GUI/Textures/noise.dds" load_file="true"/>
		<texture stage_id="1" file="Data/GUI/Textures/vignetting.dds" load_file="true"/>
	</render_draw_quad>-->
	
	<set_ant_tweak_bar/>	
	<present/>
</scene_renderer_commands>

